# 110 - POP3

## Enumeration

### Banner Grabbing

```bash
nc -nv <IP> 110
```

### Manual

You can use the command `CAPA` to obtain the capabilities of the POP3 server.

### Automated

```bash
nmap --script "pop3-capabilities or pop3-ntlm-info" -sV -port <PORT> <IP>  # All are default scripts
```

## Commands

```
USER uid           Log in as "uid"
PASS password      Substitue "password" for your actual password
STAT               List number of messages, total mailbox size
LIST               List messages and sizes
RETR n             Show message n
DELE n             Mark message n for deletion
RSET               Undo any changes
QUIT               Logout (expunges messages if no RSET)
TOP msg n          Show first n lines of message number msg
CAPA               Get capabilities
```

## Brute Force

### Hydra

```bash
hydra -l USERNAME -P /path/to/passwords.txt -f <IP> pop3 -V
hydra -S -v -l USERNAME -P /path/to/passwords.txt -s 995 -f <IP> pop3 -V
```

### Metasploit

```bash
use auxiliary/scanner/pop3/pop3_login
```

